<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <title>スプラスケジュール</title>
  <script src="https://unpkg.com/vue@3.0.0"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div id="app1">
    <table class="schedule">
      <template v-for="schedule in scheduleList">
        <tr class="date-row">
          <td colspan="3">2024/12/15</td>
        </tr>
        <tr>
          <th>時間</th>
          <th>モード</th>
          <th>ステージ</th>
        </tr>
        <tr v-for="item in schedule">
          <td class="time-slot">{{ item.start_time_view }}</td>
          <td>
            {{ item.rule.name }}
          </td>
          <td class="stage">
            <div class="stage-list">
              <div>
                <div class="stage-name">{{ item.stages[0].name }}</div>
                <img :src="item.stages[0].image" :alt="item.stages[0].name" />
              </div>
              <div>
                <div class="stage-name">{{ item.stages[1].name }}</div>
                <img :src="item.stages[1].image" :alt="item.stages[1].name" />
              </div>
            </div>
          </td>
        </tr>
      </template>
    </table>
    <!-- 追加の行をここに挿入 -->
  </div>

  <script>
    function convertTime(results) {
      results.forEach(function (result) {
        const date = new Date(result['start_time']);
        // 時と分を取得してフォーマット
        const hours = date.getHours().toString().padStart(2, "0");
        const minutes = date.getMinutes().toString().padStart(2, "0");
        const timeString = `${hours}:${minutes}～`;
        result['start_time_view'] = timeString;
      });

      return results;
    }
    var scheduleList = []
    const App1 = {
      data() {
        return {
          scheduleList: scheduleList
        }
      }
    }
    // GETリクエストを実行
    axios.get('https://spla3.yuu26.com/api/bankara-open/schedule')
      .then(response => {
        // リクエストが成功した場合、データを表示
        //Vueコンポーネントを定義
        scheduleList.push(convertTime(response.data.results));
        const app = Vue.createApp(App1) //Vueアプリケーションを作成
        app.mount('#app1') //VueアプリケーションをHTML要素にマウント
      })
      .catch(error => {
        // リクエストが失敗した場合、エラーを表示
        console.error('Error:', error);
      });
  </script>
</body>

</html>